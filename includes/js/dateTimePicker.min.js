function dropIt(){if(calendarSpanElementStyle){calendarSpanElementStyle=null}}function dragIt(a){if(calendarSpanElementStyle){if(document.addEventListener){calendarSpanElementStyle.left=a.clientX-currentLeft+document.body.scrollLeft+"px";calendarSpanElementStyle.top=a.clientY-currentTop+document.body.scrollTop+"px"}else{calendarSpanElementStyle.left=a.clientX-currentLeft+document.body.scrollLeft+"px";calendarSpanElementStyle.top=a.clientY-currentTop+document.body.scrollTop+"px"}}}function pickIt(a){var b;var c;if(document.addEventListener){b=a.target.id;if(b===calendarSpanID){c=document.getElementById(b);currentLeft=a.pageX;currentTop=a.pageY;if(c.offsetLeft){currentLeft-=c.offsetLeft;currentTop-=c.offsetTop}mousePosX=a.pageX;mousePosY=a.pageY}else{c=this;currentLeft=a.offsetX;currentTop=a.offsetY;mousePosX=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-(document.documentElement.clientLeft||0);mousePosY=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-(document.documentElement.clientTop||0)}}if(b===calendarSpanID){calendarSpanElementStyle=document.getElementById(b).style}if(calendarSpanElementStyle){calendarSpanElementStyle.zIndex=100;return false}else{calendarSpanElementStyle=null;return}}function selectDate(a,b){Cal.Date=b;selectedDate=new Date(Cal.Year,Cal.Month,Cal.Date);a.style.background=SelectedDateBackgroundColor;showCalendar()}function closeCalendar(a){if(Cal.ShowTime===true){var b=dateTimeToday.getFullYear()+endYear;if(Cal.Year<=b&&Cal.Year>=startYear&&Cal.Month===selectedDate.getMonth()&&Cal.Year===selectedDate.getFullYear()){if(Cal.EnableDateMode==="future"){if(Cal.Date<dateTimeToday.getDate()&&Cal.Month===dateTimeToday.getMonth()&&Cal.Year===dateTimeToday.getFullYear()||Cal.Month<dateTimeToday.getMonth()&&Cal.Year===dateTimeToday.getFullYear()||Cal.Year<dateTimeToday.getFullYear()){callback(a,Cal.FormatDate(Cal.Date))}}else{callback(a,Cal.FormatDate(Cal.Date))}}}var c=document.getElementById(a);c.focus();calendarMainWindow.style.visibility="hidden"}function newCalendar(a,b,c,d,e,f,g){dateTimeToday=new Date;Cal=new Calendar(dateTimeToday);if(typeof d!=="undefined"){if(d===true){Cal.ShowTime=true}else{Cal.ShowTime=false}if(typeof e!=="undefined"){if(parseInt(e,10)===12||parseInt(e,10)===24){TimeMode=e}else{TimeMode=e}}if(typeof f!=="undefined"){if(f===true){Cal.ShowSeconds=true}else{Cal.ShowSeconds=false}}else{Cal.ShowSeconds=false}}if(typeof a!=="undefined"){Cal.Ctrl=a}if(typeof b!=="undefined"&&b.replace(/^\s+|\s+$/gi,"")!==""){Cal.Format=b.toUpperCase()}else{Cal.Format="MMDDYYYY"}if(typeof c!=="undefined"&&c.replace(/^\s+|\s+$/gi,"")!==""){if(c.toUpperCase()==="DROPDOWN"){Cal.Scroller="DROPDWON"}else{Cal.Scroller="DROPDWON"}}else{Cal.Scroller="DROPDWON"}if(typeof c!=="undefined"&&(g==="future"||g==="past")){Cal.EnableDateMode=g}exDateTime=document.getElementById(a).value;if(exDateTime){var h=exDateTime.indexOf(DateSeparator,0);var i=exDateTime.indexOf(DateSeparator,parseInt(h,10)+1);var j;var k;var l=parseInt(Cal.Format.toUpperCase().lastIndexOf("M"),10)-parseInt(Cal.Format.toUpperCase().indexOf("M"),10)-1;var m;var n;var o;var p=/^\d{4}$/;if(Cal.Format.toUpperCase()==="DDMMYYYY"||Cal.Format.toUpperCase()==="DDMMMYYYY"){if(DateSeparator.replace(/^\s+|\s+$/gi,"")===""){m=exDateTime.substring(0,2);n=exDateTime.substring(2,4+l);o=exDateTime.substring(4+l,8+l)}else{if(exDateTime.indexOf("D*")!==-1){m=exDateTime.substring(0,2);n=exDateTime.substring(8,11);o="20"+exDateTime.substring(11,13)}else{m=exDateTime.substring(0,h);n=exDateTime.substring(h+1,i);o=exDateTime.substring(i+1,i+5)}}}else if(Cal.Format.toUpperCase()==="MMDDYYYY"||Cal.Format.toUpperCase()==="MMMDDYYYY"){if(DateSeparator.replace(/^\s+|\s+$/gi,"")===""){m=exDateTime.substring(2+l,4+l);n=exDateTime.substring(0,2+l);o=exDateTime.substring(4+l,8+l)}else{m=exDateTime.substring(h+1,i);n=exDateTime.substring(0,h);o=exDateTime.substring(i+1,i+5)}}else if(Cal.Format.toUpperCase()==="YYYYMMDD"||Cal.Format.toUpperCase()==="YYYYMMMDD"){if(DateSeparator.replace(/^\s+|\s+$/gi,"")===""){m=exDateTime.substring(6+l,8+l);n=exDateTime.substring(4,6+l);o=exDateTime.substring(0,4)}else{m=exDateTime.substring(i+1,i+3);n=exDateTime.substring(h+1,i);o=exDateTime.substring(0,h)}}else if(Cal.Format.toUpperCase()==="YYMMDD"||Cal.Format.toUpperCase()==="YYMMMDD"){if(DateSeparator.replace(/^\s+|\s+$/gi,"")===""){m=exDateTime.substring(4+l,6+l);n=exDateTime.substring(2,4+l);o=exDateTime.substring(0,2)}else{m=exDateTime.substring(i+1,i+3);n=exDateTime.substring(h+1,i);o=exDateTime.substring(0,h)}}if(isNaN(n)===true){n=Cal.GetMonthIndex(n)}else{n=parseInt(n,10)-1}if(parseInt(n,10)>=0&&parseInt(n,10)<12){Cal.Month=n}if(p.test(o)){if(parseInt(o,10)>=startYear&&parseInt(o,10)<=dateTimeToday.getFullYear()+endYear){Cal.Year=parseInt(o,10)}}if(parseInt(m,10)<=Cal.GetMonthDays()&&parseInt(m,10)>=1){Cal.Date=m}if(Cal.ShowTime===true){if(parseInt(TimeMode,10)===12){Cal.AMorPM=exDateTime.substring(exDateTime.length-2,exDateTime.length)}j=exDateTime.indexOf(":",0);k=exDateTime.indexOf(":",parseInt(j,10)+1);if(parseInt(j,10)>0){Cal.SetHour(exDateTime.substring(j,j-2));Cal.SetMinute(exDateTime.substring(j+1,j+3));Cal.SetSecond(exDateTime.substring(parseInt(k,10)+1,parseInt(k,10)+3))}else if(parseInt(exDateTime.indexOf("D*"),10)!==-1){Cal.SetHour(exDateTime.substring(2,4));Cal.SetMinute(exDateTime.substring(4,6))}}}selectedDate=new Date(Cal.Year,Cal.Month,Cal.Date);showCalendar(true)}function showCalendar(a){var b="";var c="";var d;var e="";var f="";var g="";var h;var i;var j=0;var k;var l="35px";var m;var n;var o;var p;var q;calendarHeight=0;if(typeof a==="undefined"||a!==true){a=false}b+="<span style='cursor:default;'>";c+="<table id='broCalendar' style='background-color:"+calendarBackgroundColor+";width:200px;padding:0;margin:5px auto;'><tbody>";c+="<tr><td colspan='7'><table border='0' width='200px' cellpadding='0' cellspacing='0'><tr>";c+="<td align='left'><select name='MonthSelector' onChange='javascript:Cal.SwitchMonth(this.selectedIndex);showCalendar();'>";for(var r=0;r<12;r++){if(r===Cal.Month){g="selected"}else{g=""}c+="<option "+g+" value="+r+">"+MonthName[r]+"</option>\n"}c+="</select></td>\n";c+="<td align='right'><select name='YearSelector' size='1' onChange='javascript:Cal.SwitchYear(this.value);showCalendar();'>";for(var r=startYear;r<=dateTimeToday.getFullYear()+endYear;r++){if(r===Cal.Year){g="selected"}else{g=""}c+="<option "+g+" value="+r+">"+r+"</option>\n"}c+="</select></td>\n";calendarHeight+=30;c+="</tr></table></td></tr>";if(ShowMonthYear===true&&Cal.Scroller==="DROPDOWN"){c+="<tr><td colspan='7' class='calR' style='color:"+MonthYearColor+";'>"+Cal.GetMonthName(ShowLongMonth)+" "+Cal.Year+"</td></tr>";calendarHeight+=19}c+="<tr><td colspan='7'><table style='border-spacing:1px;border-collapse:separate;'><tr>";for(var r=0;r<7;r++){c+="<td style='background-color:"+WeekHeadBackgroundColor+";width:"+CellWidth+"px;color:#000;' class='calTD'>"+WeekDay[r].substr(0,WeekCharNumber)+"</td>"}calendarHeight+=19;c+="</tr>";i=new Date(Cal.Year,Cal.Month);i.setDate(1);k=i.getDay();k--;if(k===-1){k=6}d="<tr>";calendarHeight+=19;for(var r=0;r<k;r++){d+=GenCell();j++}for(var r=1;r<=Cal.GetMonthDays();r++){if(j%7===0&&r>1){d+="<tr>"}j++;if(Cal.EnableDateMode==="future"&&(r<dateTimeToday.getDate()&&Cal.Month===dateTimeToday.getMonth()&&Cal.Year===dateTimeToday.getFullYear()||Cal.Month<dateTimeToday.getMonth()&&Cal.Year===dateTimeToday.getFullYear()||Cal.Year<dateTimeToday.getFullYear())){h=GenCell(r,false,DisableBackgroundColor,false)}else if(Cal.EnableDateMode==="past"&&(r>=dateTimeToday.getDate()&&Cal.Month===dateTimeToday.getMonth()&&Cal.Year===dateTimeToday.getFullYear()||Cal.Month>dateTimeToday.getMonth()&&Cal.Year===dateTimeToday.getFullYear()||Cal.Year>dateTimeToday.getFullYear())){h=GenCell(r,false,DisableBackgroundColor,false)}else if(Cal.Year>dateTimeToday.getFullYear()+endYear){h=GenCell(r,false,DisableBackgroundColor,false)}else if(r===dateTimeToday.getDate()&&Cal.Month===dateTimeToday.getMonth()&&Cal.Year===dateTimeToday.getFullYear()){h=GenCell(r,true,TodayBackgroundColor)}else{if(r===selectedDate.getDate()&&Cal.Month===selectedDate.getMonth()&&Cal.Year===selectedDate.getFullYear()){h=GenCell(r,true,SelectedDateBackgroundColor)}else{if(j%7===0){h=GenCell(r,false,SundayBackgroundColor)}else if((j+1)%7===0){h=GenCell(r,false,SaturdayBackgroundColor)}else{h=GenCell(r,null,WeekDayBackgroundColor)}}}d+=h;if(j%7===0&&r<Cal.GetMonthDays()){d+="</tr>";calendarHeight+=19}}if(j%7!==0){while(j%7!==0){d+=GenCell();j++}}d+="</table></td></tr>";if(Cal.ShowTime===true){var s=Cal.getShowHour();f="<tr><td colspan='7' style='text-align:center;'><table border='0' width='199px' cellpadding='0' cellspacing='0'><tbody><tr><td height='5px' width='"+l+"'> </td>";f+="<td width='22px'><input type='text' name='hour' maxlength=2 size=1 style='width:22px' value="+s+" onkeyup='javascript:Cal.SetHour(this.value)'>";f+="</td><td style='font-weight:bold;text-align:center;'>:</td><td width='22px'>";f+="<input type='text' name='minute' maxlength=2 size=1 style='width:22px' value="+Cal.Minutes+" onkeyup='javascript:Cal.SetMinute(this.value)'>";if(Cal.ShowSeconds===true){f+="</td><td style='font-weight:bold;'>:</td><td width='22px'>";f+="<input type='text' name='second' maxlength=2 size=1 style='width: 22px' value="+Cal.Seconds+" onkeyup='javascript:Cal.SetSecond(parseInt(this.value,10))'>"}if(parseInt(TimeMode,10)===12){f+="</td><td><select name='ampm' onChange='javascript:Cal.SetAmPm(this.options[this.selectedIndex].value);'>\n";if(Cal.AMorPM==="AM"){f+="<option value='AM' selected>AM</option>"}else{f+="<option value='AM'>AM</option>"}if(Cal.AMorPM==="PM"){f+="<option value='PM' selected>PM</option>"}else{f+="<option value='PM'>PM</option>"}f+="</select>"}f+="</td>\n<td align='right' valign='bottom' width='"+l+"px'></td></tr>";f+="<tr><td colspan='8' style='text-align:center;'><input style='width:60px;font-size:12px;' onClick='javascript:closeCalendar(\""+Cal.Ctrl+"\");'  type='button' value='OK'> <input style='width:60px;font-size:12px;' onClick='javascript:calendarMainWindow.style.visibility=\"hidden\"' type='button' value='Cancel'></td></tr>"}else{f+="\n<tr>\n<td colspan='7' style='text-align:right;'>";e+="<input style='width:60px;font-size:12px;' id='close_cal' title='close' onmousedown='javascript:closeCalendar(\""+Cal.Ctrl+"\");' type='button' value='Cancel'></td></tr>"}e+="</tbody></table></td></tr>";calendarHeight+=31;e+="</tbody></table>\n</span>";if(mousePosY>calendarHeight){mousePosY-=calendarHeight}if(!calendarMainWindow){m=document.getElementsByTagName("head")[0];n=".calTD {font-family: verdana; font-size: 12px; text-align: center; border:0;}\n";n+=".calR {font-family: verdana; font-size: 12px; text-align: center; font-weight: bold;}";o=document.createElement("style");o.type="text/css";o.rel="stylesheet";if(o.styleSheet){o.styleSheet.cssText=n}else{p=document.createTextNode(n);o.appendChild(p)}m.appendChild(o);q=document.createElement("span");q.id=calendarSpanID;q.style.position="absolute";q.style.left=mousePosX+CalendarPosOffsetX+"px";q.style.top=mousePosY-CalendarPosOffsetY+"px";q.style.width=CalendarWidth+"px";q.style.border="1px solid "+SpanBorderColor;q.style.padding="0";q.style.cursor="move";q.style.backgroundColor=SpanBackgroundColor;q.style.zIndex=100;document.body.appendChild(q);calendarMainWindow=document.getElementById(calendarSpanID)}else{calendarMainWindow.style.visibility="visible";calendarMainWindow.style.Height=calendarHeight;if(a===true){calendarMainWindow.style.left=mousePosX+CalendarPosOffsetX+"px";calendarMainWindow.style.top=mousePosY-CalendarPosOffsetY+"px"}}calendarMainWindow.innerHTML=b+c+d+f+e;return true}function callback(a,b){var c=document.getElementById(a);if(typeof b==="undefined"){var d=new Date;b=d.getDate()+"/"+(d.getMonth()+1)+"/"+d.getFullYear()}c.value=b;if(Cal.ShowTime===true){c.value+=" "+Cal.getShowHour()+":"+Cal.Minutes;if(Cal.ShowSeconds===true){c.value+=":"+Cal.Seconds}if(parseInt(TimeMode,10)===12){c.value+=""+Cal.getShowAMorPM()}}if(c.onchange!=undefined){c.onchange()}c.focus();calendarMainWindow.style.visibility="hidden"}function GenCell(a,b,c,d){var e;var f;if(typeof a==="undefined"||!a){a=""}if(typeof c==="undefined"){c=calendarBackgroundColor}if(typeof d==="undefined"){d=true}if(Cal.ShowTime){e=" "+Cal.Hours+":"+Cal.Minutes;if(Cal.ShowSeconds===true){e+=":"+Cal.Seconds}if(parseInt(TimeMode,10)===12){e+=" "+Cal.AMorPM}}else{e=""}if(a!==""){if(d===true){if(Cal.ShowTime===true){f="<td id='c"+a+"' class='calTD' style='text-align:center;cursor:pointer;background-color:"+c+"' onmousedown='selectDate(this,"+a+");'>"+a+"</td>"}else{f="<td class='calTD' style='text-align:center;cursor:pointer;background-color:"+c+"' onClick=\"javascript:callback('"+Cal.Ctrl+"','"+Cal.FormatDate(a)+"');\">"+a+"</td>"}}else{f="<td style='text-align:center;background-color:"+c+"' class='calTD'>"+a+"</td>"}}else{f="<td style='text-align:center;background-color:"+c+"' class='calTD'> </td>"}return f}function Calendar(a,b){this.Date=a.getDate();this.Month=a.getMonth();this.Year=a.getFullYear();this.Hours=a.getHours();if(a.getMinutes()<10){this.Minutes="0"+a.getMinutes()}else{this.Minutes=a.getMinutes()}if(a.getSeconds()<10){this.Seconds="0"+a.getSeconds()}else{this.Seconds=a.getSeconds()}this.Ctrl=b;this.Format="YYYYMMDD";this.ShowTime=false;this.Scroller="DROPDOWN";if(a.getHours()<12){this.AMorPM="AM"}else{this.AMorPM="PM"}this.ShowSeconds=false;this.EnableDateMode=""}var Cal;var exDateTime;var calendarMainWindow;var calendarSpanElementStyle;var dateTimeToday;var selectedDate;var mousePosX=0;var mousePosY=0;var calendarHeight=0;var CalendarPosOffsetX=-1;var CalendarPosOffsetY=0;var CalendarWidth=208;var currentLeft="0";var currentTop="0";var calendarSpanID="calBorder";var WeekDay=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];var MonthName=["January","February","March","April","May","June","July","August","September","October","November","December"];var calendarBackgroundColor="#fff";var MonthYearColor="#000";var WeekHeadBackgroundColor="#c5c5c5";var SelectedDateBackgroundColor="#aaa";var TodayBackgroundColor="#f00";var DisableBackgroundColor="#fff";var SundayBackgroundColor="#d5d5d5";var SaturdayBackgroundColor="#e5e5e5";var WeekDayBackgroundColor="#f5f5f5";var SpanBorderColor="#ccc";var SpanBackgroundColor="#fff";var startYear=2010;var endYear=10;var CellWidth=30;var TimeMode=24;var WeekCharNumber=2;var ShowMonthYear=true;var ShowLongMonth=true;var PrecedeZero=true;var DateSeparator="-";Calendar.prototype.GetMonthIndex=function(a){for(var b=0;b<12;b++){if(MonthName[b].substring(0,3).toUpperCase()===a.toUpperCase()){return b}}};Calendar.prototype.SwitchMonth=function(a){Cal.Month=parseInt(a,10)};Calendar.prototype.SwitchYear=function(a){Cal.Year=parseInt(a,10)};Calendar.prototype.GetMonthName=function(a){var b=MonthName[this.Month];if(a){return b}else{return b.substr(0,3)}};Calendar.prototype.SetHour=function(a){var b;var c;var d=new RegExp("^\\d{1}$");var e=new RegExp("^\\d{2}$");if(parseInt(TimeMode,10)===24){b=23;c=0}else if(parseInt(TimeMode,10)===12){b=12;c=1}else{alert("Invalid TimeMode.")}if((e.test(a)||d.test(a))&&parseInt(a,10)>b){a=c}else if((e.test(a)||d.test(a))&&parseInt(a,10)<c){a=b}if(d.test(a)){a="0"+a}if(e.test(a)&&parseInt(a,10)<=b&&parseInt(a,10)>=c){if(parseInt(TimeMode,10)===12&&Cal.AMorPM=="PM"){if(parseInt(a,10)===12){Cal.Hours=12}else{Cal.Hours=parseInt(a,10)+12}}else if(parseInt(TimeMode,10)===12&&Cal.AMorPM==="AM"){if(parseInt(a,10)===12){a=parseInt(a,10)-12}Cal.Hours=parseInt(a,10)}else if(parseInt(TimeMode,10)===24){Cal.Hours=parseInt(a,10)}}};Calendar.prototype.SetMinute=function(a){var b=59;var c=0;var d=new RegExp("^\\d{1}$");var e=new RegExp("^\\d{2}$");if((e.test(a)||d.test(a))&&parseInt(a,10)>b){a=c}else if((e.test(a)||d.test(a))&&parseInt(a,10)<c){a=b}if(d.test(a)){a="0"+a}if((e.test(a)||d.test(a))&&parseInt(a,10)<=b&&parseInt(a,10)>=c){Cal.Minutes=a}};Calendar.prototype.SetSecond=function(a){var b=59;var c=0;var d=new RegExp("^\\d{1}$");var e=new RegExp("^\\d{2}$");if((e.test(a)||d.test(a))&&parseInt(a,10)>b){a=c}else if((e.test(a)||d.test(a))&&parseInt(a,10)<c){a=b}if(d.test(a)){a="0"+a}if((e.test(a)||d.test(a))&&parseInt(a,10)<=b&&parseInt(a,10)>=c){Cal.Seconds=a}};Calendar.prototype.SetAmPm=function(a){this.AMorPM=a;if(a==="PM"){this.hours+=12;if(this.Hours===24){this.Hours=12}}else if(a==="AM"){this.Hours-=12}};Calendar.prototype.getShowHour=function(){var a;if(parseInt(TimeMode,10)===12){if(parseInt(this.Hours,10)===0){this.AMorPM="AM";a=12}else if(parseInt(this.Hours,10)===12){this.AMorPM="PM";a=12}else if(this.Hours>12){this.AMorPM="PM";if(this.Hours-12<10&&String(this.Hours-12).length===1){a="0"+(parseInt(this.Hours,10)-12)}else{a=parseInt(this.Hours,10)-12}}else{this.AMorPM="AM";if(this.Hours<10&&String(this.Hours).length===1){a="0"+parseInt(this.Hours,10)}else{a=parseInt(this.Hours,10)}}}else if(parseInt(TimeMode,10)===24){if(this.Hours<10){a="0"+parseInt(this.Hours,10)}else{a=parseInt(this.Hours,10)}}return a};Calendar.prototype.getShowAMorPM=function(){return this.AMorPM};Calendar.prototype.GetMonthDays=function(){var a=[31,28,31,30,31,30,31,31,30,31,30,31];if(Cal.IsLeapYear()===true){a[1]=29}return a[this.Month]};Calendar.prototype.IsLeapYear=function(){if(this.Year%4===0){if(this.Year%100===0&&this.Year%400!==0){return false}else{return true}}else{return false}};Calendar.prototype.FormatDate=function(a){var b=this.Month+1;if(PrecedeZero===true){if(a<10&&String(a).length===1){a="0"+a}if(b<10&&String(b).length===1){b="0"+b}}switch(this.Format.toUpperCase()){case"DDMMYYYY":return a+DateSeparator+b+DateSeparator+this.Year;case"DDMMMYYYY":return a+DateSeparator+this.GetMonthName(false)+DateSeparator+this.Year;case"MMDDYYYY":return b+DateSeparator+a+DateSeparator+this.Year;case"MMMDDYYYY":return this.GetMonthName(false)+DateSeparator+a+DateSeparator+this.Year;case"YYYYMMDD":return this.Year+DateSeparator+b+DateSeparator+a;case"YYMMDD":return String(this.Year).substring(2,4)+DateSeparator+b+DateSeparator+a;case"YYMMMDD":return String(this.Year).substring(2,4)+DateSeparator+this.GetMonthName(false)+DateSeparator+a;case"YYYYMMDD":return this.Year+DateSeparator+this.GetMonthName(false)+DateSeparator+a;default:return a+DateSeparator+(this.Month+1)+DateSeparator+this.Year}};document.onmousedown=pickIt;document.onmousemove=dragIt;document.onmouseup=dropIt